(()=>{var e={593:e=>{"use strict";e.exports=require("https://jslib.k6.io/url/1.0.0/index.js")},795:e=>{"use strict";e.exports=require("k6/encoding")},255:e=>{"use strict";e.exports=require("k6/html")},409:e=>{"use strict";e.exports=require("k6/http")},97:(e,r,t)=>{const n=t(409);e.exports.get=function(e,r){return n.get(e,r)},e.exports.post=function(e,r,t){return n.post(e,r,t)}},175:(e,r,t)=>{const n=t(934),s=t(731),o=t(97);var a,i;e.exports.getAuthorizationToken=function(e,r,t){if(a=e,i=r,!(void 0===e&&""===e.trim()||void 0===i&&""===i.trim()||void 0===t&&""===t.trim())){console.log("username: "+a),console.log("password:  "+i),console.log("url: "+t);var c=!1,u=t;!1===u.endsWith("/")&&(u+="/"),u+="settings.js",console.log("settings js url: "+u);let e=o.get(u);if(e.status>400){if(console.log("status: "+e.status),console.log("settings.js not found so getting settings.json"),!1===(u=t).endsWith("/")&&(u+="/"),u+="settings.json",e=o.get(u),console.log("json response: "+e.status),e.status>400)throw console.error(`Request to ${e.request.url} returned with status ${e.status}`),new Error("Invalid Client URL");c=!0}return c?function(e){var r,t=new RegExp(/"AUTHORIZATION_CLIENT_ID":([^,\r\n}]*)/).exec(e.body),c=t[1].trim().replace(/"/g,"");r=null!=(t=new RegExp(/scopes:([^,\r\n}]*)/).exec(e.body))&&t.length>=1?t[1].trim().replace(/"/g,""):"ingr.api";var u,d=(t=new RegExp(/"AUTHORIZATION_REDIRECT_URI":([^,\r\n}]*)/).exec(e.body))[1].trim().replace(/"/g,"");u=(t=new RegExp(/"AUTHORIZATION_IDENTITYPROVIDER":([^,\r\n}]*)/).exec(e.body))[1].trim().replace(/"/g,"");var l=void 0;null!=(t=new RegExp(/resource:([^,\r\n}]*)/).exec(e.body))&&t.length>=1&&(l=t[1].trim().replace(/"/g,"")),console.log("resource: "+l);var p=(t=new RegExp(/"AUTHORIZATION_USEPKCE":([^,\r\n}]*)/).exec(e.body))[1].trim().replace(/"/g,"");(t=new RegExp(/"AUTHORIZATION_DUMMYCLIENTSECRET":([^,\r\n]*)/).exec(e.body)).length<1&&void 0===t[1]&&console.error("dummyClientSecret not found.");var g=t[1].trim().replace(/"/g,""),h=(t=new RegExp(/"ODATA_DOMAIN_URL":([^,\r\n}]*)/).exec(e.body))[1].trim().replace(/"/g,"");!1===h.endsWith("/")&&(h+="/"),h=h+(t=new RegExp(/"ODATA_SERVICE_NAME":([^,\r\n}]*)/).exec(e.body))[1].trim().replace(/"/g,"")+"/api/v2/SDA/";var R=new URL(h),w=R.pathname.split("/").filter((e=>e)),x="";w.length>=1&&(x=R.origin+"/"+w[0]);var v;if(v=R.origin,!((e=o.get(h+"description")).status>400)){var m=JSON.parse(e.body.replace(/[\r\n\t]/g,"")),y=m.TokenIssuerUri;void 0!==l&&""!==l||(l=m.TokenAudience);var _;return _=void 0===u||""===u?{OKTA:{authURL:y,clientId:c,clientSecret:g,scopes:r,usePKCE:p,odataURL:h,odataBaseURL:x,hostURL:v,redirectUri:d,userCredential:{username:a,password:i}}}:{SAM:{authURL:y,clientId:c,clientSecret:g,scopes:r,usePKCE:p,odataURL:h,odataBaseURL:x,hostURL:v,redirectUri:d,identityProvider:u,resource:l,userCredential:{username:a,password:i}}},console.debug("Settings: "+JSON.stringify(_)),void 0!==_.OKTA?n.getOktaAuthorizationToken(_.OKTA):s.getSamAuthorizationToken(_.SAM)}console.error(`Request to ${e.request.url} returned with status ${e.status}`)}(e):function(e){var r=new RegExp(/clientId:([^,\r\n}]*)/).exec(e.body);null==r&&(r=new RegExp(/"clientId":([^,\r\n}]*)/).exec(e.body));var t,c=r[1].trim().replace(/"/g,"");t=null!=(r=new RegExp(/scopes:([^,\r\n}]*)/).exec(e.body))&&r.length>=1?r[1].trim().replace(/"/g,""):"ingr.api",null==(r=new RegExp(/redirectUri:([^,\r\n}]*)/).exec(e.body))&&(r=new RegExp(/"redirectUri":([^,\r\n}]*)/).exec(e.body));var u,d=r[1].trim().replace(/"/g,"");null==(r=new RegExp(/identityProvider:([^,\r\n}]*)/).exec(e.body))&&(r=new RegExp(/"identityProvider":([^,\r\n}]*)/).exec(e.body)),u=r[1].trim().replace(/"/g,"");var l=void 0;null!=(r=new RegExp(/resource:([^,\r\n}]*)/).exec(e.body))&&r.length>=1&&(l=r[1].trim().replace(/"/g,"")),null==(r=new RegExp(/usePKCE:([^,\r\n}]*)/).exec(e.body))&&(r=new RegExp(/"usePKCE":([^,\r\n}]*)/).exec(e.body));var p=r[1].trim().replace(/"/g,"");null==(r=new RegExp(/dummyClientSecret:([^,\r\n]*)/).exec(e.body))&&(r=new RegExp(/"dummyClientSecret":([^,\r\n]*)/).exec(e.body)),r.length<1&&void 0===r[1]&&console.error("dummyClientSecret not found.");var g,h=r[1].trim().replace(/"/g,"");null==(r=new RegExp(/domainUrl:([^,\r\n}]*)/).exec(e.body))&&(r=new RegExp(/"domainUrl":([^,\r\n}]*)/).exec(e.body)),null==r?(null==(r=new RegExp(/url:([^,\r\n}]*)/).exec(e.body))&&(r=new RegExp(/"url":([^,\r\n}]*)/).exec(e.body)),!1===(g=r[1].trim().replace(/"/g,"")).endsWith("/")&&(g+="/"),console.log("odataURL: "+g)):(!1===(g=r[1].trim().replace(/"/g,"")).endsWith("/")&&(g+="/"),null==(r=new RegExp(/serviceName:([^,\r\n}]*)/).exec(e.body))&&(r=new RegExp(/"serviceName":([^,\r\n}]*)/).exec(e.body)),g=g+r[1].trim().replace(/"/g,"")+"/api/v2/SDA/");var R=new URL(g),w=R.pathname.split("/").filter((e=>e)),x="";w.length>=1&&(x=R.origin+"/"+w[0]);var v;if(v=R.origin,console.log("hostURL: "+v),console.log(g+"description"),!((e=o.get(g+"description")).status>400)){var m=JSON.parse(e.body.replace(/[\r\n\t]/g,"")),y=m.TokenIssuerUri;void 0!==l&&""!==l||(l=m.TokenAudience);var _;return _=void 0===u||""===u?{OKTA:{authURL:y,clientId:c,clientSecret:h,scopes:t,usePKCE:p,odataURL:g,odataBaseURL:x,hostURL:v,redirectUri:d,userCredential:{username:a,password:i}}}:{SAM:{authURL:y,clientId:c,clientSecret:h,scopes:t,usePKCE:p,odataURL:g,odataBaseURL:x,hostURL:v,redirectUri:d,identityProvider:u,resource:l,userCredential:{username:a,password:i}}},console.debug("Settings: "+JSON.stringify(_)),void 0!==_.OKTA?n.getOktaAuthorizationToken(_.OKTA):s.getSamAuthorizationToken(_.SAM)}console.error(`Request to ${e.request.url} returned with status ${e.status}`)}(e)}}},934:(e,r,t)=>{const n=t(409),s=t(795),o=t(593),a=t(97);e.exports.getOktaAuthorizationToken=function(e){console.log("OKTASettings: ",JSON.stringify(e));var r=new n.CookieJar;const t=e.authURL,i=e.clientId,c=e.usePKCE,u=e.userCredential.username,d=e.userCredential.password,l=e.clientSecret,p=e.redirectUri,g=e.scopes,h="state";let R;if("true"===c.toLowerCase()){const e=`${new o.URL(t).origin}/api/v1/authn`;var w={username:u,password:d},x={headers:{"Content-Type":"application/json"},jar:r};R=a.post(e,JSON.stringify(w),x),R.status>400&&console.error(`Request to ${R.request.url} returned with status ${R.status}`);var v=JSON.parse(R.body).sessionToken;const n=new o.URL(`${t}/v1/authorize`);if(n.searchParams.append("client_id",i),n.searchParams.append("code_challenge","h80cqY8rnCLt6_4c9K3uaaitV5M26tROeoqFIUIl-BI"),n.searchParams.append("code_challenge_method","S256"),n.searchParams.append("redirect_uri",p),n.searchParams.append("response_type","code"),n.searchParams.append("sessionToken",v),n.searchParams.append("state",h),n.searchParams.append("nonce","nonce"),n.searchParams.append("scope",g),x={headers:{"Content-Type":"application/json"},redirects:0},R=a.get(n.toString(),x),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`);if(R.url.includes("signin"))throw new Error(" Invalid Login Credentials  ");var m=new RegExp(/code=([^&]*)/).exec(R.headers.Location.toString())[1];const s=new o.URL(`${t}/v1/token`);s.searchParams.append("state",h);var y={headers:{"Content-Type":"application/x-www-form-urlencoded"},jar:r};const c={};if(c.client_id=i,c.grant_type="authorization_code",c.redirect_uri=p,c.code=m,c.code_verifier="0LG2f0VQBDHBiF_h2tVxFtGhVnGB~MpC6ifc-S1MCuZWC8644u7ZrIb3xlDMU.4a53ESoH_yqhi.d1be3fPcVs1.z1Td7R4zncl~-AxrJ2JPPtEUS9joBtbOu.BQyFR8",R=a.post(s.toString(),c,y),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`)}else{const e=new o.URL(`${t}/v1/token`),n={scope:g};if(""===u){n.grant_type="client_credentials";const t={auth:"basic",headers:{Authorization:`Basic ${s.b64encode(`${i}:${l}`)}`},jar:r};if(R=a.post(e.toString(),n,t),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`)}else if(n.grant_type="password",n.username=u,n.password=d,n.client_id=i,n.client_secret=l,R=a.post(e.toString(),n),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`)}return e.accessToken=R.json().access_token,e}},731:(e,r,t)=>{const n=t(409),s=t(255),o=t(97);e.exports.getSamAuthorizationToken=function(e){var r=new n.CookieJar;const t=e.authURL,a=e.clientId,i=e.usePKCE,c=e.userCredential.username,u=e.userCredential.password,d=e.clientSecret,l=e.identityProvider,p=e.resource,g=e.redirectUri,h=e.scopes;let R;if("true"===i.toLowerCase()){const e=new URL(`${t}/connect/authorize`);e.searchParams.append("client_id",a),e.searchParams.append("client_secret",d),e.searchParams.append("code_challenge","h80cqY8rnCLt6_4c9K3uaaitV5M26tROeoqFIUIl-BI"),e.searchParams.append("code_challenge_method","S256"),e.searchParams.append("redirect_uri",g),e.searchParams.append("response_type","code"),e.searchParams.append("state","state"),e.searchParams.append("nonce","nonce"),e.searchParams.append("scope",h),e.searchParams.append("acr_values",`idp:${l}`);var w={headers:{"Content-Type":"application/x-www-form-urlencoded"}};if(R=o.get(e.toString(),{jar:r}),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`);const n=s.parseHTML(R.body).find("html").children("body").children("script").text(),i=JSON.parse(n.replace(/&quot;/g,'"')),y=new RegExp(/signin=([^&]*)/).exec(i.loginUrl.toString())[1],_=i.antiForgery.value,U=new URL(`${t}/login`);U.searchParams.append("signin",y);var x={headers:{"Content-Type":"application/x-www-form-urlencoded"},jar:r},v={};if(v.username=c,v.password=u,v.provider=l,v["idsrv.xsrf"]=_,R=void 0,R=o.post(U.toString(),v,x),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`);if(R.url.includes("signin"))throw new Error(" Invalid Login Credentials  ");var m=new RegExp(/code=([^&]*)/).exec(R.url)[1];const E=new URL(`${t}/connect/token`);if(x={headers:{"Content-Type":"application/x-www-form-urlencoded"},jar:r},(v={}).client_id=a,v.client_secret=d,v.code=m,v.code_verifier="0LG2f0VQBDHBiF_h2tVxFtGhVnGB~MpC6ifc-S1MCuZWC8644u7ZrIb3xlDMU.4a53ESoH_yqhi.d1be3fPcVs1.z1Td7R4zncl~-AxrJ2JPPtEUS9joBtbOu.BQyFR8",v.grant_type="authorization_code",v.redirect_uri=g,v.resource=p,R=o.post(E.toString(),v,x),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`)}else{const e=new URL(`${t}/connect/token`),r={scope:h};if(""===c){if(r.grant_type="client_credentials",r.resource=p,r.client_id=a,r.client_secret=d,R=o.post(e.toString(),r,w),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`)}else if(r.grant_type="password",r.username=c,r.password=u,r.client_id=a,r.client_secret=d,r.resource=p,R=o.post(e.toString(),r),R.status>400)return void console.error(`Request to ${R.request.url} returned with status ${R.status}`)}return e.accessToken=R.json().access_token,e}}},r={},t=function t(n){var s=r[n];if(void 0!==s)return s.exports;var o=r[n]={exports:{}};return e[n](o,o.exports,t),o.exports}(175),n=exports;for(var s in t)n[s]=t[s];t.__esModule&&Object.defineProperty(n,"__esModule",{value:!0})})();