(()=>{var e={593:e=>{"use strict";e.exports=require("https://jslib.k6.io/url/1.0.0/index.js")},795:e=>{"use strict";e.exports=require("k6/encoding")},255:e=>{"use strict";e.exports=require("k6/html")},409:e=>{"use strict";e.exports=require("k6/http")},97:(e,r,t)=>{const s=t(409);e.exports.get=function(e,r){return s.get(e,r)},e.exports.post=function(e,r,t){return s.post(e,r,t)}},175:(e,r,t)=>{const s=t(934),n=t(731),o=t(97);e.exports.getAuthorizationToken=function(e,r,t){if(!(void 0===e&&""===e.trim()||void 0===r&&""===r.trim()||void 0===t&&""===t.trim())){var a=e;console.log("username: "+a),console.log("password:  "+r),console.log("url: "+t);var i=t;!1===i.endsWith("/")&&(i+="/"),i+="settings.js";let s=o.get(i);if(s.status>400)return void console.error(`Request to ${s.request.url} returned with status ${s.status}`);var c=new RegExp(/clientId:([^,\r\n}]*)/).exec(s.body);null==c&&(c=new RegExp(/"clientId":([^,\r\n}]*)/).exec(s.body));var u,d=c[1].trim().replace(/"/g,"");u=null!=(c=new RegExp(/scopes:([^,\r\n}]*)/).exec(s.body))&&c.length>=1?c[1].trim().replace(/"/g,""):"ingr.api",null==(c=new RegExp(/redirectUri:([^,\r\n}]*)/).exec(s.body))&&(c=new RegExp(/"redirectUri":([^,\r\n}]*)/).exec(s.body));var p,l=c[1].trim().replace(/"/g,"");null==(c=new RegExp(/identityProvider:([^,\r\n}]*)/).exec(s.body))&&(c=new RegExp(/"identityProvider":([^,\r\n}]*)/).exec(s.body)),p=c[1].trim().replace(/"/g,"");var g=void 0;null!=(c=new RegExp(/resource:([^,\r\n}]*)/).exec(s.body))&&c.length>=1&&(g=c[1].trim().replace(/"/g,"")),null==(c=new RegExp(/usePKCE:([^,\r\n}]*)/).exec(s.body))&&(c=new RegExp(/"usePKCE":([^,\r\n}]*)/).exec(s.body));var h=c[1].trim().replace(/"/g,"");null==(c=new RegExp(/dummyClientSecret:([^,\r\n]*)/).exec(s.body))&&(c=new RegExp(/"dummyClientSecret":([^,\r\n]*)/).exec(s.body)),c.length<1&&void 0===c[1]&&console.error("dummyClientSecret not found.");var w,x=c[1].trim().replace(/"/g,"");null==(c=new RegExp(/domainUrl:([^,\r\n}]*)/).exec(s.body))&&(c=new RegExp(/"domainUrl":([^,\r\n}]*)/).exec(s.body)),null==c?(null==(c=new RegExp(/url:([^,\r\n}]*)/).exec(s.body))&&(c=new RegExp(/"url":([^,\r\n}]*)/).exec(s.body)),!1===(w=c[1].trim().replace(/"/g,"")).endsWith("/")&&(w+="/"),console.log("odataURL: "+w)):(!1===(w=c[1].trim().replace(/"/g,"")).endsWith("/")&&(w+="/"),null==(c=new RegExp(/serviceName:([^,\r\n}]*)/).exec(s.body))&&(c=new RegExp(/"serviceName":([^,\r\n}]*)/).exec(s.body)),w=w+c[1].trim().replace(/"/g,"")+"/api/v2/SDA/");var m=new URL(w),v=m.pathname.split("/").filter((e=>e)),R="";if(v.length>=1&&(R=m.origin+"/"+v[0]),console.log(w+"description"),s=o.get(w+"description"),s.status>400)return void console.error(`Request to ${s.request.url} returned with status ${s.status}`);var y=JSON.parse(s.body.replace(/[\r\n\t]/g,"")),_=y.TokenIssuerUri;void 0!==g&&""!==g||(g=y.TokenAudience);var f={};f=void 0===p||""===p?{OKTA:{authURL:_,clientId:d,clientSecret:x,scopes:u,usePKCE:h,odataURL:w,odataBaseURL:R,redirectUri:l,userCredential:{username:a,password:r}}}:{SAM:{authURL:_,clientId:d,clientSecret:x,scopes:u,usePKCE:h,odataURL:w,odataBaseURL:R,redirectUri:l,identityProvider:p,resource:g,userCredential:{username:a,password:r}}}}return console.debug("Settings: "+JSON.stringify(f)),void 0!==f.OKTA?s.getOktaAuthorizationToken(f.OKTA):n.getSamAuthorizationToken(f.SAM)}},934:(e,r,t)=>{const s=t(409),n=t(795),o=t(593),a=t(97);e.exports.getOktaAuthorizationToken=function(e){console.log("OKTASettings: ",JSON.stringify(e));var r=new s.CookieJar;const t=e.authURL,i=e.clientId,c=e.usePKCE,u=e.userCredential.username,d=e.userCredential.password,p=e.clientSecret,l=e.redirectUri,g=e.scopes,h="state";let w;if("true"===c.toLowerCase()){const e=`${new o.URL(t).origin}/api/v1/authn`;var x={username:u,password:d},m={headers:{"Content-Type":"application/json"},jar:r};w=a.post(e,JSON.stringify(x),m),w.status>400&&console.error(`Request to ${w.request.url} returned with status ${w.status}`);var v=JSON.parse(w.body).sessionToken;const s=new o.URL(`${t}/v1/authorize`);if(s.searchParams.append("client_id",i),s.searchParams.append("code_challenge","h80cqY8rnCLt6_4c9K3uaaitV5M26tROeoqFIUIl-BI"),s.searchParams.append("code_challenge_method","S256"),s.searchParams.append("redirect_uri",l),s.searchParams.append("response_type","code"),s.searchParams.append("sessionToken",v),s.searchParams.append("state",h),s.searchParams.append("nonce","nonce"),s.searchParams.append("scope",g),m={headers:{"Content-Type":"application/json"},redirects:0},w=a.get(s.toString(),m),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`);var R=new RegExp(/code=([^&]*)/).exec(w.headers.Location.toString())[1];const n=new o.URL(`${t}/v1/token`);n.searchParams.append("state",h);var y={headers:{"Content-Type":"application/x-www-form-urlencoded"},jar:r};const c={};if(c.client_id=i,c.grant_type="authorization_code",c.redirect_uri=l,c.code=R,c.code_verifier="0LG2f0VQBDHBiF_h2tVxFtGhVnGB~MpC6ifc-S1MCuZWC8644u7ZrIb3xlDMU.4a53ESoH_yqhi.d1be3fPcVs1.z1Td7R4zncl~-AxrJ2JPPtEUS9joBtbOu.BQyFR8",w=a.post(n.toString(),c,y),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`)}else{const e=new o.URL(`${t}/v1/token`),s={scope:g};if(""===u){s.grant_type="client_credentials";const t={auth:"basic",headers:{Authorization:`Basic ${n.b64encode(`${i}:${p}`)}`},jar:r};if(w=a.post(e.toString(),s,t),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`)}else if(s.grant_type="password",s.username=u,s.password=d,s.client_id=i,s.client_secret=p,w=a.post(e.toString(),s),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`)}return e.accessToken=w.json().access_token,e}},731:(e,r,t)=>{const s=t(409),n=t(255),o=t(97);e.exports.getSamAuthorizationToken=function(e){var r=new s.CookieJar;const t=e.authURL,a=e.clientId,i=e.usePKCE,c=e.userCredential.username,u=e.userCredential.password,d=e.clientSecret,p=e.identityProvider,l=e.resource,g=e.redirectUri,h=e.scopes;let w;if("true"===i.toLowerCase()){const e=new URL(`${t}/connect/authorize`);e.searchParams.append("client_id",a),e.searchParams.append("client_secret",d),e.searchParams.append("code_challenge","h80cqY8rnCLt6_4c9K3uaaitV5M26tROeoqFIUIl-BI"),e.searchParams.append("code_challenge_method","S256"),e.searchParams.append("redirect_uri",g),e.searchParams.append("response_type","code"),e.searchParams.append("state","state"),e.searchParams.append("nonce","nonce"),e.searchParams.append("scope",h),e.searchParams.append("acr_values",`idp:${p}`);var x={headers:{"Content-Type":"application/x-www-form-urlencoded"}};if(w=o.get(e.toString(),{jar:r}),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`);const s=n.parseHTML(w.body).find("html").children("body").children("script").text(),i=JSON.parse(s.replace(/&quot;/g,'"')),y=new RegExp(/signin=([^&]*)/).exec(i.loginUrl.toString())[1],_=i.antiForgery.value,f=new URL(`${t}/login`);f.searchParams.append("signin",y);var m={headers:{"Content-Type":"application/x-www-form-urlencoded"},jar:r},v={};if(v.username=c,v.password=u,v.provider=p,v["idsrv.xsrf"]=_,w=void 0,w=o.post(f.toString(),v,m),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`);var R=new RegExp(/code=([^&]*)/).exec(w.url)[1];const S=new URL(`${t}/connect/token`);if(m={headers:{"Content-Type":"application/x-www-form-urlencoded"},jar:r},(v={}).client_id=a,v.client_secret=d,v.code=R,v.code_verifier="0LG2f0VQBDHBiF_h2tVxFtGhVnGB~MpC6ifc-S1MCuZWC8644u7ZrIb3xlDMU.4a53ESoH_yqhi.d1be3fPcVs1.z1Td7R4zncl~-AxrJ2JPPtEUS9joBtbOu.BQyFR8",v.grant_type="authorization_code",v.redirect_uri=g,v.resource=l,w=o.post(S.toString(),v,m),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`)}else{const e=new URL(`${t}/connect/token`),r={scope:h};if(""===c){if(r.grant_type="client_credentials",r.resource=l,r.client_id=a,r.client_secret=d,w=o.post(e.toString(),r,x),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`)}else if(r.grant_type="password",r.username=c,r.password=u,r.client_id=a,r.client_secret=d,r.resource=l,w=o.post(e.toString(),r),w.status>400)return void console.error(`Request to ${w.request.url} returned with status ${w.status}`)}return e.accessToken=w.json().access_token,e}}},r={},t=function t(s){var n=r[s];if(void 0!==n)return n.exports;var o=r[s]={exports:{}};return e[s](o,o.exports,t),o.exports}(175),s=exports;for(var n in t)s[n]=t[n];t.__esModule&&Object.defineProperty(s,"__esModule",{value:!0})})();